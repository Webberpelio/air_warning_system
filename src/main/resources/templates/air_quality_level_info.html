<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Air pollutants concentration prediction</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="/css/present.css">
</head>
<script type="text/javascript" src="/js/echarts.js"></script>
<body>
<p class="para_style" th:text="'这里是' + ${city} + '!'" />
<div style="margin: 80px auto">
    <table>
        <thead>
        <tr>
            <th>日期</th>
            <th>空气质量等级</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="record : ${res}">
            <td th:text="${record.date}"></td>
            <td th:text="${record.airQualityLevel}"></td>
        </tr>
        </tbody>
    </table>
</div>

<!--<div id="main" style="width: 700px;height:400px;"></div>-->
<div id="main" class="curve"></div>

<script th:inline="javascript">
    //基于服务端返回的响应数据，准备绘图所需数据
    var resList = [[${res}]];
    var dateList = [];
    var airQualityLevelList = [];
    resList.forEach(item => {dateList.push(item.date)});
    resList.forEach(item => {airQualityLevelList.push(item.airQualityLevel)});

    var draw = function(containerId, dataList, legend, xLegend) {
        //基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById(containerId));

        //指定图表的配置项和数据
        var option = {
            title: {
                text: legend,
                left: 'center'
            },
            tooltip: {},
            legend: {
                data: [legend],
                show: false
            },
            xAxis: {
                data: xLegend
            },
            yAxis: {},
            series: [
                {
                    name: legend,
                    type: 'line',
                    smooth: true,
                    data: dataList
                }
            ]
        };

        //使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    }

    draw("main", airQualityLevelList, "空气质量等级", dateList);
</script>
</body>
</html>